<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SYNVIKO</title>
<style>
body{
font-family:Arial;
background:#0b132b;
color:white;
padding:15px;
}
input,select,button{
width:100%;
padding:12px;
margin:5px 0;
border-radius:8px;
border:none;
}
button{
background:#2563eb;
color:white;
font-weight:bold;
}
.panel{
background:#1c2541;
padding:15px;
border-radius:10px;
margin-bottom:15px;
}
.hidden{display:none;}
.card{
background:#3a506b;
padding:10px;
border-radius:8px;
margin:5px 0;
}
</style>
</head>
<body>

<h2>SYNVIKO</h2>

<!-- REGISTRO -->
<div class="panel">
<h3>Solicitar registro</h3>
<input id="nombre" placeholder="Nombre">
<input id="telefono" placeholder="Teléfono">
<select id="tipo">
<option value="cliente">Cliente</option>
<option value="motorizado">Motorizado</option>
</select>
<button onclick="registrar()">Enviar solicitud</button>
</div>

<!-- NUEVO PEDIDO -->
<div class="panel">
<h3>Nuevo envío</h3>
<input id="cliente" placeholder="Nombre cliente">
<input id="recogida" placeholder="Dirección recogida">
<input id="entrega" placeholder="Dirección entrega">
<button onclick="calcular()">Calcular tarifa</button>
<h3 id="tarifa"></h3>
<button onclick="crearPedido()">Crear pedido</button>
</div>

<!-- PEDIDOS -->
<div class="panel">
<h3>Pedidos activos</h3>
<div id="pedidos"></div>
</div>

<!-- ADMIN -->
<div class="panel">
<h3>Panel Administrador</h3>
<input id="passAdmin" placeholder="Contraseña">
<button onclick="loginAdmin()">Entrar</button>
<div id="adminPanel" class="hidden">
<h4>Solicitudes pendientes</h4>
<div id="solicitudes"></div>
</div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"></script>

<script>
const firebaseConfig = {
apiKey: "AIzaSyClYtHMWFy6eyUg4eXMo_1zlQE9a3Occ04",
authDomain: "synviko-97da5.firebaseapp.com",
databaseURL: "https://synviko-97da5-default-rtdb.firebaseio.com",
projectId: "synviko-97da5",
storageBucket: "synviko-97da5.firebasestorage.app",
messagingSenderId: "770434547807",
appId: "1:770434547807:web:e6f456509a996d69aa1bea"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

function registrar(){
db.ref("solicitudes").push({
nombre: document.getElementById("nombre").value,
telefono: document.getElementById("telefono").value,
tipo: document.getElementById("tipo").value,
estado:"pendiente"
});
alert("Solicitud enviada");
}

function calcular(){
let km = Math.floor(Math.random()*10)+1;
let precio = km*0.5;
window.precioActual = precio;
document.getElementById("tarifa").innerText="Tarifa: $"+precio;
}

function crearPedido(){
db.ref("pedidos").push({
cliente: document.getElementById("cliente").value,
recogida: document.getElementById("recogida").value,
entrega: document.getElementById("entrega").value,
precio: window.precioActual||0,
estado:"pendiente"
});
alert("Pedido creado");
}

db.ref("pedidos").on("value", snap=>{
let pedidosDiv=document.getElementById("pedidos");
pedidosDiv.innerHTML="";
snap.forEach(p=>{
let d=p.val();
pedidosDiv.innerHTML+=`
<div class="card">
Cliente: ${d.cliente}<br>
Entrega: ${d.entrega}<br>
Precio: $${d.precio}<br>
Estado: ${d.estado}
</div>`;
});
});

function loginAdmin(){
let clave = document.getElementById("passAdmin").value;
if(clave=="1234"){
document.getElementById("adminPanel").classList.remove("hidden");
cargarSolicitudes();
}else alert("Clave incorrecta");
}

function cargarSolicitudes(){
db.ref("solicitudes").on("value", snap=>{
let solicitudesDiv=document.getElementById("solicitudes");
solicitudesDiv.innerHTML="";
snap.forEach(s=>{
let d=s.val();
if(d.estado=="pendiente"){
solicitudesDiv.innerHTML+=`
<div class="card">
${d.nombre} - ${d.tipo}
<button onclick="aprobar('${s.key}')">Aprobar</button>
</div>`;
}
});
});
}

function aprobar(id){
db.ref("solicitudes/"+id).update({estado:"aprobado"});
}
</script>

</body>
</html>
